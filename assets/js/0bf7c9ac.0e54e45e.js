"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[3374],{3905:(t,e,a)=>{a.d(e,{Zo:()=>p,kt:()=>h});var n=a(7294);function r(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function i(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function l(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?i(Object(a),!0).forEach((function(e){r(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function o(t,e){if(null==t)return{};var a,n,r=function(t,e){if(null==t)return{};var a,n,r={},i=Object.keys(t);for(n=0;n<i.length;n++)a=i[n],e.indexOf(a)>=0||(r[a]=t[a]);return r}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)a=i[n],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(t,a)&&(r[a]=t[a])}return r}var c=n.createContext({}),s=function(t){var e=n.useContext(c),a=e;return t&&(a="function"==typeof t?t(e):l(l({},e),t)),a},p=function(t){var e=s(t.components);return n.createElement(c.Provider,{value:e},t.children)},d={inlineCode:"code",wrapper:function(t){var e=t.children;return n.createElement(n.Fragment,{},e)}},u=n.forwardRef((function(t,e){var a=t.components,r=t.mdxType,i=t.originalType,c=t.parentName,p=o(t,["components","mdxType","originalType","parentName"]),u=s(a),h=r,m=u["".concat(c,".").concat(h)]||u[h]||d[h]||i;return a?n.createElement(m,l(l({ref:e},p),{},{components:a})):n.createElement(m,l({ref:e},p))}));function h(t,e){var a=arguments,r=e&&e.mdxType;if("string"==typeof t||r){var i=a.length,l=new Array(i);l[0]=u;var o={};for(var c in e)hasOwnProperty.call(e,c)&&(o[c]=e[c]);o.originalType=t,o.mdxType="string"==typeof t?t:r,l[1]=o;for(var s=2;s<i;s++)l[s]=a[s];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},3919:(t,e,a)=>{function n(t){return!0===/^(\w*:|\/\/)/.test(t)}function r(t){return void 0!==t&&!n(t)}a.d(e,{b:()=>n,Z:()=>r})},4996:(t,e,a)=>{a.d(e,{C:()=>i,Z:()=>l});var n=a(2263),r=a(3919);function i(){const{siteConfig:{baseUrl:t="/",url:e}={}}=(0,n.Z)();return{withBaseUrl:(a,n)=>function(t,e,a,{forcePrependBaseUrl:n=!1,absolute:i=!1}={}){if(!a)return a;if(a.startsWith("#"))return a;if((0,r.b)(a))return a;if(n)return e+a;const l=a.startsWith(e)?a:e+a.replace(/^\//,"");return i?t+l:l}(e,t,a,n)}}function l(t,e={}){const{withBaseUrl:a}=i();return a(t,e)}},8215:(t,e,a)=>{a.d(e,{Z:()=>r});var n=a(7294);const r=function({children:t,hidden:e,className:a}){return n.createElement("div",{role:"tabpanel",hidden:e,className:a},t)}},1395:(t,e,a)=>{a.d(e,{Z:()=>p});var n=a(7294),r=a(944),i=a(6010);const l="tabItem_1uMI",o="tabItemActive_2DSg";const c=37,s=39;const p=function(t){const{lazy:e,block:a,defaultValue:p,values:d,groupId:u,className:h}=t,{tabGroupChoices:m,setTabGroupChoices:f}=(0,r.Z)(),[g,k]=(0,n.useState)(p),y=n.Children.toArray(t.children),N=[];if(null!=u){const t=m[u];null!=t&&t!==g&&d.some((e=>e.value===t))&&k(t)}const b=t=>{const e=t.currentTarget,a=N.indexOf(e),n=d[a].value;k(n),null!=u&&(f(u,n),setTimeout((()=>{(function(t){const{top:e,left:a,bottom:n,right:r}=t.getBoundingClientRect(),{innerHeight:i,innerWidth:l}=window;return e>=0&&r<=l&&n<=i&&a>=0})(e)||(e.scrollIntoView({block:"center",behavior:"smooth"}),e.classList.add(o),setTimeout((()=>e.classList.remove(o)),2e3))}),150))},_=t=>{var e;let a;switch(t.keyCode){case s:{const e=N.indexOf(t.target)+1;a=N[e]||N[0];break}case c:{const e=N.indexOf(t.target)-1;a=N[e]||N[N.length-1];break}}null==(e=a)||e.focus()};return n.createElement("div",{className:"tabs-container"},n.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.Z)("tabs",{"tabs--block":a},h)},d.map((({value:t,label:e})=>n.createElement("li",{role:"tab",tabIndex:g===t?0:-1,"aria-selected":g===t,className:(0,i.Z)("tabs__item",l,{"tabs__item--active":g===t}),key:t,ref:t=>N.push(t),onKeyDown:_,onFocus:b,onClick:b},e)))),e?(0,n.cloneElement)(y.filter((t=>t.props.value===g))[0],{className:"margin-vert--md"}):n.createElement("div",{className:"margin-vert--md"},y.map(((t,e)=>(0,n.cloneElement)(t,{key:e,hidden:t.props.value!==g})))))}},9443:(t,e,a)=>{a.d(e,{Z:()=>n});const n=(0,a(7294).createContext)(void 0)},944:(t,e,a)=>{a.d(e,{Z:()=>i});var n=a(7294),r=a(9443);const i=function(){const t=(0,n.useContext)(r.Z);if(null==t)throw new Error("`useUserPreferencesContext` is used outside of `Layout` Component.");return t}},7840:(t,e,a)=>{a.d(e,{s:()=>r});var n=a(7294);function r({id:t,aspectRatio:e=4/3,hd:a="0"}){return n.createElement("p",{style:{position:"relative",paddingBottom:1/e*100+"%"}},n.createElement("iframe",{src:`https://gfycat.com/ifr/${t}?hd=${a}`,scrolling:"no",frameBorder:"0",allowFullScreen:!0,width:"100%",height:"100%",style:{position:"absolute",top:0,left:0}}))}},8173:(t,e,a)=>{a.d(e,{s:()=>c});var n=a(2177),r=a(8215),i=a(1395),l=a(7294);const o={lua:"Lua",ts:"TypeScript",tsx:"TypeScript",js:"JavaScript",jsx:"JavaScript"};function c({children:t,group:e,titles:a}){(0,n.Z)("string"==typeof e||void 0===e);const c=l.Children.toArray(t).map(((t,e)=>{var n;const r=(null==(n=t.props.children.props.className)?void 0:n.replace(/language-/,""))??`Tab ${e+1}`;return{id:e,languageName:(void 0!==a&&a.length>0?a.split("|"):[])[e]??o[r]??r,element:t}}));return l.createElement(i.Z,{groupId:void 0!==e?`multi-code-block-${e}`:void 0,defaultValue:c[0].id,values:c.map((({id:t,languageName:e})=>({value:t,label:e})))},c.map((({id:t,element:e})=>l.createElement(r.Z,{key:t,value:t},e))))}},6776:(t,e,a)=>{a.d(e,{X:()=>i});var n=a(4996),r=a(7294);function i({path:t,controls:e=!1}){return r.createElement("video",{width:"100%",height:"100%",autoPlay:!0,muted:!0,loop:!0,controls:e},r.createElement("source",{src:(0,n.Z)(t),type:"video/mp4"}))}},8129:(t,e,a)=>{a.d(e,{_:()=>r});var n=a(7294);function r({id:t,playlistId:e,aspectRatio:a=16/9}){const r=void 0!==e?`https://www.youtube.com/embed/videoseries?list=${e}`:`https://www.youtube.com/embed/${t}`;return n.createElement("p",{style:{position:"relative",paddingBottom:1/a*100+"%"}},n.createElement("iframe",{src:r,frameBorder:"0",allowFullScreen:!0,width:"100%",height:"100%",style:{position:"absolute",top:0,left:0}}))}},1696:(t,e,a)=>{a.r(e),a.d(e,{frontMatter:()=>i,metadata:()=>l,toc:()=>o,default:()=>s});var n=a(7462),r=(a(7294),a(3905));a(1395),a(8215),a(7840),a(8129),a(8173),a(6776);const i={title:"Particle Attachment",author:"Noya",steamId:"76561198046984233",date:"13.01.2015"},l={unversionedId:"scripting/particle-attachment",id:"scripting/particle-attachment",isDocsHomePage:!1,title:"Particle Attachment",description:"Particle Types",source:"@site/_articles/scripting/particle-attachment.md",sourceDirName:"scripting",slug:"/scripting/particle-attachment",permalink:"/scripting/particle-attachment",editUrl:"https://github.com/ModDota/moddota.github.io/edit/source/_articles/scripting/particle-attachment.md",version:"current",frontMatter:{title:"Particle Attachment",author:"Noya",steamId:"76561198046984233",date:"13.01.2015"},sidebar:"tutorials",previous:{title:"Using the order filter and other filters",permalink:"/scripting/using-dota-filters"},next:{title:"Basic Vector Math",permalink:"/scripting/vector-math"}},o=[{value:"Particle Types",id:"particle-types",children:[]},{value:"Parents and Childs",id:"parents-and-childs",children:[]},{value:"Attachments",id:"attachments",children:[]},{value:"Control Points",id:"control-points",children:[{value:"Decompiled Particles",id:"decompiled-particles",children:[]}]},{value:"Examples",id:"examples",children:[{value:"1. Simple buff particles, datadriven",id:"1-simple-buff-particles-datadriven",children:[]},{value:"2. Basic attachment",id:"2-basic-attachment",children:[]},{value:"3. Control Points",id:"3-control-points",children:[]},{value:"4. Control Point Entities",id:"4-control-point-entities",children:[]},{value:"5. Stopping a Lua Particle",id:"5-stopping-a-lua-particle",children:[]},{value:"6. Difference between &quot;FireEffect&quot; and &quot;AttachEffect&quot;",id:"6-difference-between-fireeffect-and-attacheffect",children:[]},{value:"7. Projectile Particles",id:"7-projectile-particles",children:[]}]}],c={toc:o};function s({components:t,...e}){return(0,r.kt)("wrapper",(0,n.Z)({},c,e,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"particle-types"},"Particle Types"),(0,r.kt)("p",null,"  Each particle system in Dota is designed for a certain purpose, for example: "),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Buff/Debuff or Ambient effect"),(0,r.kt)("li",{parentName:"ul"},"Explosions and other limited-time effects"),(0,r.kt)("li",{parentName:"ul"},"Circle AoE Indicators"),(0,r.kt)("li",{parentName:"ul"},"Line Indicators"),(0,r.kt)("li",{parentName:"ul"},"Projectiles (Linear or Tracking)"),(0,r.kt)("li",{parentName:"ul"},"Others")),(0,r.kt)("p",null,"When attempting to use some of the available particles, keep in mind what was the original behavior of it."),(0,r.kt)("p",null,"For example if you try to use a projectile particle as a buff, or an explosion as a projectile, you will get disastrous or just no effect at all."),(0,r.kt)("p",null,'You can browse particles in the asset browser, for filtering just write keywords like "particle" or "vpcf".'),(0,r.kt)("p",null,"Also every time you use a particle, remember to add them in a datadriven precache block on the ability:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'"precache"\n{\n    "particle"  "particles/units/heroes/hero_magnataur/magnataur_shockwave.vpcf"\n}\n')),(0,r.kt)("p",null,"Else you won't see them unless they belonged originally to the hero that is casting them."),(0,r.kt)("h2",{id:"parents-and-childs"},"Parents and Childs"),(0,r.kt)("p",null,"  A Parent Particle is indicated by a P in the Asset Broswer."),(0,r.kt)("p",null,"  ",(0,r.kt)("img",{parentName:"p",src:"https://puu.sh/esM9P/998defaf12.jpg",alt:"img"})),(0,r.kt)("p",null,"  You normally want to use a Parent because it will show the complete particle effect. Childs are harder to display and might not show or display properly."),(0,r.kt)("p",null,"  ",(0,r.kt)("img",{parentName:"p",src:"https://puu.sh/esz6V/b4912e2ca5.png",alt:"img"})),(0,r.kt)("p",null,"Copy this entire path for the particleName"),(0,r.kt)("h2",{id:"attachments"},"Attachments"),(0,r.kt)("p",null,"  Particles need to be Attached to some entity location to begin its behavior.\nThis can be as easy as a single ",(0,r.kt)("inlineCode",{parentName:"p"},'"Target" "TARGET"')," line, or contain many weird attach points that you will need to discover through numerous trial and error attempts."),(0,r.kt)("p",null,"  Here is a list of every attach type, in order of importance/relevance. "),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Constant"),(0,r.kt)("th",{parentName:"tr",align:null},"String"),(0,r.kt)("th",{parentName:"tr",align:null},"Attachment Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"PATTACH_ABSORIGIN_FOLLOW"),(0,r.kt)("td",{parentName:"tr",align:null},"follow_origin"),(0,r.kt)("td",{parentName:"tr",align:null},"Follows the movement of the target at its origin location")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"PATTACH_OVERHEAD_FOLLOW"),(0,r.kt)("td",{parentName:"tr",align:null},"follow_overhead"),(0,r.kt)("td",{parentName:"tr",align:null},"Follows the movement of the target over its head")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"PATTACH_ABSORIGIN"),(0,r.kt)("td",{parentName:"tr",align:null},"attach_origin"),(0,r.kt)("td",{parentName:"tr",align:null},"Starts at the origin of the target and stays there")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"PATTACH_POINT"),(0,r.kt)("td",{parentName:"tr",align:null},"attach_hitloc"),(0,r.kt)("td",{parentName:"tr",align:null},"Normally the body of the model, where the attack projectiles hit")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"PATTACH_POINT_FOLLOW"),(0,r.kt)("td",{parentName:"tr",align:null},"follow_hitloc"),(0,r.kt)("td",{parentName:"tr",align:null},"Follows the body")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"PATTACH_CUSTOMORIGIN"),(0,r.kt)("td",{parentName:"tr",align:null},"start_at_customorigin"),(0,r.kt)("td",{parentName:"tr",align:null},"Enables the attachment to a custom origin")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"PATTACH_CUSTOMORIGIN_FOLLOW"),(0,r.kt)("td",{parentName:"tr",align:null},"follow_customorigin"),(0,r.kt)("td",{parentName:"tr",align:null},"Follow the movement of the custom origin set")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"PATTACH_WORLDORIGIN"),(0,r.kt)("td",{parentName:"tr",align:null},"world_origin"),(0,r.kt)("td",{parentName:"tr",align:null},'Targets a Point entity in the world, use with "TargetPoint" key')),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"PATTACH_EYES_FOLLOW"),(0,r.kt)("td",{parentName:"tr",align:null},"follow_eyes"),(0,r.kt)("td",{parentName:"tr",align:null},"Fills the screen, used for the damage stun or arcana drop indicator.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"PATTACH_POINT_FOLLOW_SUBSTEPPED"),(0,r.kt)("td",{parentName:"tr",align:null},"follow_attachment_substepped"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"PATTACH_RENDERORIGIN_FOLLOW"),(0,r.kt)("td",{parentName:"tr",align:null},"follow_renderorigin"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"PATTACH_ROOTBONE_FOLLOW"),(0,r.kt)("td",{parentName:"tr",align:null},"follow_rootbone"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Attach to an specific bone"),(0,r.kt)("td",{parentName:"tr",align:null},"attach_attack1"),(0,r.kt)("td",{parentName:"tr",align:null},"You can check these by opening the hero VMDL file in the Model Editor.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"-"),(0,r.kt)("td",{parentName:"tr",align:null},"start_at_origin"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"-"),(0,r.kt)("td",{parentName:"tr",align:null},"start_at_attachment"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"-"),(0,r.kt)("td",{parentName:"tr",align:null},"follow_attachment"),(0,r.kt)("td",{parentName:"tr",align:null})))),(0,r.kt)("p",null,'  Basically the engine will try to find the "bone" or attach point and type of the constant/string used,\nif the model has it and the particle is designed to properly attach to that point you will get a nice behavior. '),(0,r.kt)("p",null,"  Numerous times when dealing with complex particle systems you will get errors like:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Particle childs showing at the Vector (0,0,0). ",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"This is what normally happens when you miss a Control Point (explained later)"))),(0,r.kt)("li",{parentName:"ul"},"Effect appearing in a different position than expected. ",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Wrong attachment or particle can't attach that place.")))),(0,r.kt)("h2",{id:"control-points"},"Control Points"),(0,r.kt)("p",null,"  Control points are x,y,z values that are used to set the particle to a target entity location or a vector for radius, color, duration, speed, etc."),(0,r.kt)("p",null,"  It's easier to understand them with examples, so we'll move through some basic particles that don't need specific control points and then see some that need them to display properly."),(0,r.kt)("h3",{id:"decompiled-particles"},"Decompiled Particles"),(0,r.kt)("p",null,"With Reborn, now the default dota particles can be opened directly with the Particle Editor and make copies of them. Read more about this on the wiki in ",(0,r.kt)("a",{parentName:"p",href:"https://developer.valvesoftware.com/wiki/Dota_2_Workshop_Tools/Particle_Copy_Tool"},"Particle Copy Tool")),(0,r.kt)("h2",{id:"examples"},"Examples"),(0,r.kt)("h3",{id:"1-simple-buff-particles-datadriven"},"1. Simple buff particles, datadriven"),(0,r.kt)("p",null,"This type of particles is the easiest to attach. They are tied to a modifier and automatically stop after the modifier is destroyed."),(0,r.kt)("p",null,"For this to, the particle system duration usually needs to be infinite, designed as a simple buff, internally they have a single control point which is set with the ",(0,r.kt)("inlineCode",{parentName:"p"},"EffectAttachType")," key."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Example")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'"modifier_borrowed_time"\n{\n    "EffectName" "particles/units/heroes/hero_abaddon/abaddon_borrowed_time.vpcf"\n    "EffectAttachType" "follow_origin"\n\n    "StatusEffectName" "particles/status_fx/status_effect_abaddon_borrowed_time.vpcf"\n    "StatusEffectPriority" "15"\n}\n')),(0,r.kt)("p",null,"Status Effects are a particular type of particle that is generally applied to change the texture color of the hero, for things like illusions, ghosts, etc."),(0,r.kt)("h3",{id:"2-basic-attachment"},"2. Basic attachment"),(0,r.kt)("p",null,"When you want more than one particle attached to a modifier or the particle needs additional control points, you need to do it in a ",(0,r.kt)("inlineCode",{parentName:"p"},'"FireEffect"')," or ",(0,r.kt)("inlineCode",{parentName:"p"},'"AttachEffect"')," block instead."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'"modifier_stampede"\n{\n    "OnCreated"\n    {\n        "AttachEffect"\n        {\n            "EffectName" "particles/units/heroes/hero_centaur/centaur_stampede_overhead.vpcf"\n            "EffectAttachType" "follow_overhead"\n            "Target" "TARGET"\n        }\n    }\n}\n')),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},'"Target"')," uses the same target rules as any datadriven block"),(0,r.kt)("h3",{id:"3-control-points"},"3. Control Points"),(0,r.kt)("p",null,"When the easy attachment procedure fails, it means the particle has Control Points to control certain properties like radius, position of multiple elements, color, etc."),(0,r.kt)("p",null,"To know what each CP controls, you need to open the particle in the Particle Editor. Now you will be able to double click any of the copied particles in the Asset Browser and try to understand how to set each CP"),(0,r.kt)("p",null,"Control Points can be either set in the datadriven ",(0,r.kt)("inlineCode",{parentName:"p"},'"AttachEffect"')," or in lua.\nDoing it in Lua has the advantage that you can dynamically reload the control points by doing script_reload after changing the code."),(0,r.kt)("h4",{id:"31-lua-particle-attachment-with-setparticlecontrol"},"3.1 Lua Particle Attachment with ",(0,r.kt)("inlineCode",{parentName:"h4"},"SetParticleControl")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Example")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-lua"},'local particle = ParticleManager:CreateParticle("particles/units/heroes/hero_omniknight/omniknight_purification.vpcf", PATTACH_ABSORIGIN_FOLLOW, target)\nParticleManager:SetParticleControl(particle, 0, target:GetAbsOrigin())\nParticleManager:SetParticleControl(particle, 1, Vector(particle_radius,0,0))\n')),(0,r.kt)("p",null,"CP0 is not really needed (because this type of attachment already sets the particle to follow the AbsOrigin) but its nice to have."),(0,r.kt)("p",null,"CP1.x controls the radius of the particle, as seen in the Particle Editor after playing around with the values"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://puu.sh/esEVP/9c852a02ca.png",alt:"img"})),(0,r.kt)("p",null,'Hovering over the button tells us its a "Position along ring" '),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Example")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-lua"},'local target = event.unit\nlocal player = PlayerResource:GetPlayer( caster:GetPlayerID() )\nlocal particleName = "particles/units/heroes/hero_alchemist/alchemist_lasthit_coins.vpcf" \nlocal particle = ParticleManager:CreateParticleForPlayer( particleName, PATTACH_ABSORIGIN, target, player )\nParticleManager:SetParticleControl( particle, 0, target:GetAbsOrigin() )\nParticleManager:SetParticleControl( particle, 1, target:GetAbsOrigin() )\n')),(0,r.kt)("p",null,"In this particular case, we are using ",(0,r.kt)("inlineCode",{parentName:"p"},"CreateParticleForPlayer")," to only display it to one particular player. Could also use PATTACH_OVERHEAD_FOLLOW"),(0,r.kt)("h4",{id:"32-datadriven-controlpoints-block"},"3.2 Datadriven ",(0,r.kt)("inlineCode",{parentName:"h4"},'"ControlPoints"')," block"),(0,r.kt)("p",null,"The same can be translated to datadriven, except if you need the control points to be decided at runtime (like, doing a radius * some variable)"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'"FireEffect"\n{\n    "Target" "TARGET"\n    "EffectName" "particles/units/heroes/hero_omniknight/omniknight_purification.vpcf"\n    "EffectAttachType" "follow_origin"\n\n    "ControlPoints"\n    {\n        "00" "0 0 0"\n        "01" "%radius %radius %radius"\n    }\n}\n')),(0,r.kt)("p",null,"Keep in mind that a ",(0,r.kt)("inlineCode",{parentName:"p"},'"FireEffect"')," or ",(0,r.kt)("inlineCode",{parentName:"p"},'"AttachEffect"')," action can be inside any Ability or Modifier Event, not only on the ",(0,r.kt)("inlineCode",{parentName:"p"},'"OnCreated"')," / ",(0,r.kt)("inlineCode",{parentName:"p"},'"OnDestroy"')," Modifier Events."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Example:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'"OnSpellStart"\n{\n    "FireEffect"\n    {\n        "EffectName"       "particles/units/heroes/hero_lina/lina_spell_light_strike_array_ray_team.vpcf"\n        "EffectAttachType" "start_at_customorigin"\n        "TargetPoint"      "POINT" //This also works with world_origin\n\n        "ControlPoints"\n        {\n            "01" "%light_strike_array_aoe 0 0"\n            "03" "0 0 0"\n        }\n    }\n}\n')),(0,r.kt)("h3",{id:"4-control-point-entities"},"4. Control Point Entities"),(0,r.kt)("p",null,"Some times, particle attach points can get even more complicated when they need to be attached on specific locations or entities.\nIf your attachment is not working with the simple lua method, you need to try the next level of control point setup, the ",(0,r.kt)("strong",{parentName:"p"},"Control Point Entities"),", in either Lua or Keyvalues."),(0,r.kt)("h4",{id:"41-lua-setparticlecontrolent"},"4.1 Lua ",(0,r.kt)("inlineCode",{parentName:"h4"},"SetParticleControlEnt")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Example"),": This is the proper lua attachment for Abaddon Aphotic Shield Particle:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-lua"},'target.ShieldParticle = ParticleManager:CreateParticle("particles/units/heroes/hero_abaddon/abaddon_aphotic_shield.vpcf", PATTACH_ABSORIGIN_FOLLOW, target)\nParticleManager:SetParticleControl(target.ShieldParticle, 1, Vector(shield_size,0,shield_size))\nParticleManager:SetParticleControl(target.ShieldParticle, 2, Vector(shield_size,0,shield_size))\nParticleManager:SetParticleControl(target.ShieldParticle, 4, Vector(shield_size,0,shield_size))\nParticleManager:SetParticleControl(target.ShieldParticle, 5, Vector(shield_size,0,0))\n\nParticleManager:SetParticleControlEnt(target.ShieldParticle, 0, target, PATTACH_POINT_FOLLOW, "attach_hitloc", target:GetAbsOrigin(), true)\n')),(0,r.kt)("p",null,"PATTACH_POINT_FOLLOW puts the particle at the targets body in this case. PATTACH_ABSORIGIN_FOLLOW will put it at its feet, and PATTACH_OVERHEAD_FOLLOW at its head."),(0,r.kt)("p",null,"Note the partice being defined under the ",(0,r.kt)("inlineCode",{parentName:"p"},"target.")," handle, this is because we will need to destroy it later in Lua, becase attaching a particle this way\nwill not stop the particle effect by itself after the modifier is destroyed, as we are just tying the particle to a target.\nThis is not a concern if the particle is meant for a short duration (unlike the buff particles that last forever until removed)"),(0,r.kt)("h4",{id:"42-datadriven-controlpointentities"},"4.2 DataDriven ",(0,r.kt)("inlineCode",{parentName:"h4"},'"ControlPointEntities"')),(0,r.kt)("p",null,"This works by setting each CP in order to its key. If you need to set the CP8 to a Targets hitloc, you ",(0,r.kt)("strong",{parentName:"p"},"need"),' 8 "TARGET" (or "CASTER" or anything) lines.'),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Example")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'"modifier_aphotic_shield"\n{\n    "OnDestroy"\n    {\n        "AttachEffect"\n        {\n             "EffectName" "particles/units/heroes/hero_abaddon/abaddon_aphotic_shield_explosion.vpcf"\n             "EffectAttachType" "follow_origin"\n             "Target" "UNIT"\n             "ControlPointEntities"\n            {\n                "TARGET" "attach_origin"\n                "TARGET" "attach_origin"\n            }\n        }\n    }\n}\n')),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Example 2")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'"modifier_return"\n{\n    "Passive" "1"\n    "OnAttacked"\n    {\n        "RunScript"\n        {\n            "ScriptFile" "heroes/hero_centaur/return.lua"\n            "Function" "Return"\n        }\n        "FireEffect"\n        {\n            "EffectName" "particles/units/heroes/hero_centaur/centaur_return.vpcf"\n            "EffectAttachType" "attach_hitloc"\n            "Target" "CASTER"\n            "ControlPointEntities"\n            {\n                "CASTER" "attach_hitloc"\n                "ATTACKER" "attach_hitloc"\n            }\n        }\n    } \n}\n')),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Example 3")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'"OnProjectileHitUnit"\n{\n    "FireEffect"\n    {\n    "EffectName" "particles/units/heroes/hero_alchemist/alchemist_unstable_concoction_explosion.vpcf"\n        "EffectAttachType" "attach_hitloc"\n        "Target" "TARGET"\n        "ControlPointEntities"\n        {\n            "TARGET" "attach_hitloc" \n            "TARGET" "attach_hitloc"\n            "TARGET" "attach_hitloc"\n            "TARGET" "attach_hitloc"\n        } \n    }\n}\n')),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Example 4")),(0,r.kt)("p",null,"Custom bones!"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'"AttachEffect"\n{\n    "Target" "CASTER"\n    "EffectName" "particles/units/heroes/hero_kunkka/kunkka_weapon_tidebringer.vpcf"\n    "EffectAttachType" "start_at_customorigin"\n    "ControlPointEntities"\n    {\n        "CASTER" "attach_sword"\n        "CASTER" "attach_sword"\n        "CASTER" "attach_sword"\n    }\n}\n')),(0,r.kt)("p",null,"ControlPointEntities is the hardest method of Particle Attachment. Use it with caution and pride."),(0,r.kt)("h3",{id:"5-stopping-a-lua-particle"},"5. Stopping a Lua Particle"),(0,r.kt)("p",null,"If the entity dies, it will normally destroy the particle."),(0,r.kt)("p",null,"To stop something like we created in the Aphotic Shield example, add a ",(0,r.kt)("inlineCode",{parentName:"p"},'"OnDestroy"')," of the modifier with a RunScript that calls something like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-lua"},'function EndShieldParticle( event )\n    local target = event.target\n    target:EmitSound("Hero_Abaddon.AphoticShield.Destroy")\n    ParticleManager:DestroyParticle(target.ShieldParticle,false)\nend\n')),(0,r.kt)("p",null,"If the particle has a fixed duration you can also easily use BMD Timers:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-lua"},"Timers:CreateTimer(duration, function() \n    ParticleManager:DestroyParticle(particle,false))\nend)\n")),(0,r.kt)("h3",{id:"6-difference-between-fireeffect-and-attacheffect"},'6. Difference between "FireEffect" and "AttachEffect"'),(0,r.kt)("p",null,"When used inside a modifier, ",(0,r.kt)("em",{parentName:"p"},"AttachEffect")," will automatically stop the particle after the modifier is destroyed, while ",(0,r.kt)("em",{parentName:"p"},"FireEffect")," won't (if the particle duration is infinite)"),(0,r.kt)("p",null,"FireEffect is pretty much the same as doing the lua ",(0,r.kt)("inlineCode",{parentName:"p"},"ParticleManager:CreateParticle")," in this sense."),(0,r.kt)("p",null,"So if you FireEffect with a particle of infinite duration inside a modifier, it will still live after the modifier ends."),(0,r.kt)("p",null,"If the particle duration has a short duration, using any of the 2 Effect actions has the same results."),(0,r.kt)("h3",{id:"7-projectile-particles"},"7. Projectile Particles"),(0,r.kt)("p",null,"There are two types of projectile particles: Linear and Tracking. "),(0,r.kt)("p",null,"Linear follow a straight line and collide with anything in its path.\nUse ",(0,r.kt)("inlineCode",{parentName:"p"},'"DeleteOnHit" "0"')," inside the ",(0,r.kt)("inlineCode",{parentName:"p"},'"OnProjectileHitUnit"')," Ability Event if you want them to continue going up to its fixed distance."),(0,r.kt)("p",null,"Tracking can curve and follow a target movement. Every ranged attack particle is of this type."),(0,r.kt)("h4",{id:"linearprojectile"},"LinearProjectile"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"DataDriven Example")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'"LinearProjectile"\n{\n    "Target" "POINT"\n    "EffectName" "particles/units/heroes/hero_nyx_assassin/nyx_assassin_impale.vpcf"\n    "StartRadius" "%width"\n    "EndRadius" "%width"\n    "MoveSpeed" "%speed"\n    "TargetTeams" "DOTA_UNIT_TARGET_TEAM_ENEMY"\n    "TargetTypes" "DOTA_UNIT_TARGET_HERO | DOTA_UNIT_TARGET_BASIC"\n    "TargetFlags" "DOTA_UNIT_TARGET_FLAG_MAGIC_IMMUNE_ENEMIES"\n    "FixedDistance" "%length"\n    "ProvidesVision" "0"\n    "HasFrontalCone" "0"\n}\n')),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Lua Example")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-lua"},'--[[\n    Author: kritth\n    Date: 10.01.2015\n    Start traversing the ship\n]]\nfunction ghostship_start_traverse( keys )\n  local ability = keys.ability\n  local casterPoint = caster:GetAbsOrigin()\n  local targetPoint = keys.target_points[1]\n  local spawnDistance = ability:GetLevelSpecialValueFor( "ghostship_distance", ability:GetLevel() - 1 )\n  local projectileSpeed = ability:GetLevelSpecialValueFor( "ghostship_speed", ability:GetLevel() - 1 )\n  local radius = ability:GetLevelSpecialValueFor( "ghostship_width", ability:GetLevel() - 1 )\n\n    -- Get necessary vectors\n    local forwardVec = targetPoint - casterPoint\n            forwardVec = forwardVec:Normalized()\n    local backwardVec = casterPoint - targetPoint\n            backwardVec = backwardVec:Normalized()\n    local spawnPoint = casterPoint + ( spawnDistance * backwardVec )\n    local impactPoint = casterPoint + ( spawnDistance * forwardVec )\n    local velocityVec = Vector( forwardVec.x, forwardVec.y, 0 )\n\n    -- Spawn projectile\n    local projectileTable = {\n        Ability = ability,\n        EffectName = "particles/units/heroes/hero_kunkka/kunkka_ghost_ship.vpcf",\n        vSpawnOrigin = spawnPoint,\n        fDistance = spawnDistance * 2,\n        fStartRadius = radius,\n        fEndRadius = radius,\n        fExpireTime = GameRules:GetGameTime() + 5,\n        Source = caster,\n        bHasFrontalCone = false,\n        bReplaceExisting = false,\n        bProvidesVision = false,\n        iUnitTargetTeam = targetBuffTeam,\n        iUnitTargetType = targetType,\n        vVelocity = velocityVec * projectileSpeed\n    }\n    ProjectileManager:CreateLinearProjectile( projectileTable )\n\nend\n')),(0,r.kt)("h4",{id:"trackingprojectile"},"TrackingProjectile"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"DataDriven Example")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'"TrackingProjectile"\n{\n    "Target" "TARGET"\n    "EffectName" "particles/units/heroes/hero_alchemist/alchemist_unstable_concoction_projectile.vpcf"\n    "Dodgeable" "0"\n    "ProvidesVision" "1"\n    "VisionRadius" "%vision_range"\n    "MoveSpeed" "%movement_speed"\n    "SourceAttachment" "DOTA_PROJECTILE_ATTACHMENT_ATTACK_1"\n}\n')),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Lua Example")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-lua"},'local projectile_speed = ability:GetSpecialValueFor( "projectile_speed" )\nlocal particle_name = "particles/units/heroes/hero_abaddon/abaddon_death_coil.vpcf"\n\n-- Create the projectile\n    local info = {\n        Target = target,\n        Source = caster,\n        Ability = ability,\n        EffectName = particle_name,\n        bDodgeable = false,\n        bProvidesVision = true,\n        iMoveSpeed = projectile_speed,\n        iVisionRadius = 0,\n        iVisionTeamNumber = caster:GetTeamNumber(),\n        iSourceAttachment = DOTA_PROJECTILE_ATTACHMENT_ATTACK_1\n    }\n    ProjectileManager:CreateTrackingProjectile( info )\n')),(0,r.kt)("br",null),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Note"),": You can't generally use a particle designed to be Linear in a Tracking action and vice versa. "),(0,r.kt)("p",null,"You might be able to mimic a Linear behavior using a Tracking projectile if you make it to track a dummy unit that can't move, but you need another invisible Linear projectile to do the hit effects."))}s.isMDXComponent=!0},6010:(t,e,a)=>{function n(t){var e,a,r="";if("string"==typeof t||"number"==typeof t)r+=t;else if("object"==typeof t)if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(a=n(t[e]))&&(r&&(r+=" "),r+=a);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function r(){for(var t,e,a=0,r="";a<arguments.length;)(t=arguments[a++])&&(e=n(t))&&(r&&(r+=" "),r+=e);return r}a.d(e,{Z:()=>r})}}]);