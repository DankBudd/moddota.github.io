"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[3510],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>m});var i=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,i,o=function(e,t){if(null==e)return{};var n,i,o={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=i.createContext({}),c=function(e){var t=i.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},u=function(e){var t=c(e.components);return i.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},d=i.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),d=c(n),m=o,f=d["".concat(s,".").concat(m)]||d[m]||p[m]||r;return n?i.createElement(f,a(a({ref:t},u),{},{components:n})):i.createElement(f,a({ref:t},u))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,a=new Array(r);a[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,a[1]=l;for(var c=2;c<r;c++)a[c]=n[c];return i.createElement.apply(null,a)}return i.createElement.apply(null,n)}d.displayName="MDXCreateElement"},3919:(e,t,n)=>{function i(e){return!0===/^(\w*:|\/\/)/.test(e)}function o(e){return void 0!==e&&!i(e)}n.d(t,{b:()=>i,Z:()=>o})},4996:(e,t,n)=>{n.d(t,{C:()=>r,Z:()=>a});var i=n(2263),o=n(3919);function r(){const{siteConfig:{baseUrl:e="/",url:t}={}}=(0,i.Z)();return{withBaseUrl:(n,i)=>function(e,t,n,{forcePrependBaseUrl:i=!1,absolute:r=!1}={}){if(!n)return n;if(n.startsWith("#"))return n;if((0,o.b)(n))return n;if(i)return t+n;const a=n.startsWith(t)?n:t+n.replace(/^\//,"");return r?e+a:a}(t,e,n,i)}}function a(e,t={}){const{withBaseUrl:n}=r();return n(e,t)}},8215:(e,t,n)=>{n.d(t,{Z:()=>o});var i=n(7294);const o=function({children:e,hidden:t,className:n}){return i.createElement("div",{role:"tabpanel",hidden:t,className:n},e)}},1395:(e,t,n)=>{n.d(t,{Z:()=>u});var i=n(7294),o=n(944),r=n(6010);const a="tabItem_1uMI",l="tabItemActive_2DSg";const s=37,c=39;const u=function(e){const{lazy:t,block:n,defaultValue:u,values:p,groupId:d,className:m}=e,{tabGroupChoices:f,setTabGroupChoices:h}=(0,o.Z)(),[b,y]=(0,i.useState)(u),g=i.Children.toArray(e.children),v=[];if(null!=d){const e=f[d];null!=e&&e!==b&&p.some((t=>t.value===e))&&y(e)}const k=e=>{const t=e.currentTarget,n=v.indexOf(t),i=p[n].value;y(i),null!=d&&(h(d,i),setTimeout((()=>{(function(e){const{top:t,left:n,bottom:i,right:o}=e.getBoundingClientRect(),{innerHeight:r,innerWidth:a}=window;return t>=0&&o<=a&&i<=r&&n>=0})(t)||(t.scrollIntoView({block:"center",behavior:"smooth"}),t.classList.add(l),setTimeout((()=>t.classList.remove(l)),2e3))}),150))},w=e=>{var t;let n;switch(e.keyCode){case c:{const t=v.indexOf(e.target)+1;n=v[t]||v[0];break}case s:{const t=v.indexOf(e.target)-1;n=v[t]||v[v.length-1];break}}null==(t=n)||t.focus()};return i.createElement("div",{className:"tabs-container"},i.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":n},m)},p.map((({value:e,label:t})=>i.createElement("li",{role:"tab",tabIndex:b===e?0:-1,"aria-selected":b===e,className:(0,r.Z)("tabs__item",a,{"tabs__item--active":b===e}),key:e,ref:e=>v.push(e),onKeyDown:w,onFocus:k,onClick:k},t)))),t?(0,i.cloneElement)(g.filter((e=>e.props.value===b))[0],{className:"margin-vert--md"}):i.createElement("div",{className:"margin-vert--md"},g.map(((e,t)=>(0,i.cloneElement)(e,{key:t,hidden:e.props.value!==b})))))}},9443:(e,t,n)=>{n.d(t,{Z:()=>i});const i=(0,n(7294).createContext)(void 0)},944:(e,t,n)=>{n.d(t,{Z:()=>r});var i=n(7294),o=n(9443);const r=function(){const e=(0,i.useContext)(o.Z);if(null==e)throw new Error("`useUserPreferencesContext` is used outside of `Layout` Component.");return e}},7840:(e,t,n)=>{n.d(t,{s:()=>o});var i=n(7294);function o({id:e,aspectRatio:t=4/3,hd:n="0"}){return i.createElement("p",{style:{position:"relative",paddingBottom:1/t*100+"%"}},i.createElement("iframe",{src:`https://gfycat.com/ifr/${e}?hd=${n}`,scrolling:"no",frameBorder:"0",allowFullScreen:!0,width:"100%",height:"100%",style:{position:"absolute",top:0,left:0}}))}},8173:(e,t,n)=>{n.d(t,{s:()=>s});var i=n(2177),o=n(8215),r=n(1395),a=n(7294);const l={lua:"Lua",ts:"TypeScript",tsx:"TypeScript",js:"JavaScript",jsx:"JavaScript"};function s({children:e,group:t,titles:n}){(0,i.Z)("string"==typeof t||void 0===t);const s=a.Children.toArray(e).map(((e,t)=>{var i;const o=(null==(i=e.props.children.props.className)?void 0:i.replace(/language-/,""))??`Tab ${t+1}`;return{id:t,languageName:(void 0!==n&&n.length>0?n.split("|"):[])[t]??l[o]??o,element:e}}));return a.createElement(r.Z,{groupId:void 0!==t?`multi-code-block-${t}`:void 0,defaultValue:s[0].id,values:s.map((({id:e,languageName:t})=>({value:e,label:t})))},s.map((({id:e,element:t})=>a.createElement(o.Z,{key:e,value:e},t))))}},6776:(e,t,n)=>{n.d(t,{X:()=>r});var i=n(4996),o=n(7294);function r({path:e,controls:t=!1}){return o.createElement("video",{width:"100%",height:"100%",autoPlay:!0,muted:!0,loop:!0,controls:t},o.createElement("source",{src:(0,i.Z)(e),type:"video/mp4"}))}},8129:(e,t,n)=>{n.d(t,{_:()=>o});var i=n(7294);function o({id:e,playlistId:t,aspectRatio:n=16/9}){const o=void 0!==t?`https://www.youtube.com/embed/videoseries?list=${t}`:`https://www.youtube.com/embed/${e}`;return i.createElement("p",{style:{position:"relative",paddingBottom:1/n*100+"%"}},i.createElement("iframe",{src:o,frameBorder:"0",allowFullScreen:!0,width:"100%",height:"100%",style:{position:"absolute",top:0,left:0}}))}},4901:(e,t,n)=>{n.r(t),n.d(t,{frontMatter:()=>r,metadata:()=>a,toc:()=>l,default:()=>c});var i=n(7462),o=(n(7294),n(3905));n(1395),n(8215),n(7840),n(8129),n(8173),n(6776);const r={title:"Combining KV files using #base",author:"Perry",steamId:"76561198046986723",date:"06.04.2016"},a={unversionedId:"tools/combining-kv-files-using-base",id:"tools/combining-kv-files-using-base",isDocsHomePage:!1,title:"Combining KV files using #base",description:"Having one kv file containing every unit or ability definition as is default in the mod interface can become very annoying very quickly. Splitting up this one file into several smaller KV files makes it easier to keep an overview and manage your files. Usually people would use modkit for this, but:",source:"@site/_articles/tools/combining-kv-files-using-base.md",sourceDirName:"tools",slug:"/tools/combining-kv-files-using-base",permalink:"/tools/combining-kv-files-using-base",editUrl:"https://github.com/ModDota/moddota.github.io/edit/source/_articles/tools/combining-kv-files-using-base.md",version:"current",frontMatter:{title:"Combining KV files using #base",author:"Perry",steamId:"76561198046986723",date:"06.04.2016"},sidebar:"tutorials",previous:{title:"Setting Up Your Addon With GitHub",permalink:"/tools/setting-up-your-addon-with-github"},next:{title:"Contribute",permalink:"/contribute"}},l=[{value:"How it works",id:"how-it-works",children:[]},{value:"Credits for pointing out this is part of the KV spec:",id:"credits-for-pointing-out-this-is-part-of-the-kv-spec",children:[]}],s={toc:l};function c({components:e,...t}){return(0,o.kt)("wrapper",(0,i.Z)({},s,t,{components:e,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Having one kv file containing every unit or ability definition as is default in the mod interface can become very annoying very quickly. Splitting up this one file into several smaller KV files makes it easier to keep an overview and manage your files. Usually people would use modkit for this, but:"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"https://github.com/stephenfournier/Dota-2-ModKit"},"ModKit")," is not needed to combine KV files")),(0,o.kt)("p",null,"Thanks to some detective work done in #steamdb and some testing on my part, we discovered dota KV has a working #base directive, which tells the engine to combine another KV file with the current one."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"This method works for:")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Unit/Ability definition files (like npc_units_custom.txt or npc_abilities_custom.txt)."),(0,o.kt)("li",{parentName:"ul"},"Custom key value files loaded into lua with LoadKeyValues."),(0,o.kt)("li",{parentName:"ul"},"Localisation files (addon_english.txt)")),(0,o.kt)("h2",{id:"how-it-works"},"How it works"),(0,o.kt)("p",null,"Assume we start with one file at path ",(0,o.kt)("inlineCode",{parentName:"p"},"scripts/npc/npc_abilities_custom.txt")," with the following content:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'"DOTAAbilities"\n{\n    "Ability1"\n    {\n        "SomeProperty1"    "1"\n        "SomeProperty2"    "2"\n    }\n\n    "Ability2"\n    {\n        "SomeProperty1"    "1"\n        "SomeProperty2"    "2"\n    }\n}\n')),(0,o.kt)("p",null,"Now let's say we want to split this up into two files, we can create another file ",(0,o.kt)("inlineCode",{parentName:"p"},"scripts/npc/abilities_2.txt"),". This file has to have a root element just like the other files, we can just copy DOTAAbilities. Also copy the content to be separated so this is the result:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'"DOTAAbilities"\n{\n    "Ability2"\n    {\n        "SomeProperty1"    "1"\n        "SomeProperty2"    "2"\n    }\n}\n')),(0,o.kt)("p",null,"Now edit the main file to include this new abilities_2.txt file by adding ",(0,o.kt)("inlineCode",{parentName:"p"},'#base "[relativePath]"'),", this results in:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'#base "abilities_2.txt"\n"DOTAAbilities"\n{\n    "Ability1"\n    {\n        "SomeProperty1"    "1"\n        "SomeProperty2"    "2"\n    }\n}\n')),(0,o.kt)("p",null,"When loading this KV file, the engine will now automatically add the contents of abilities_2.txt to npc_abilities_custom.txt by combining the two root objects in both files. This means that the name of the root object does not matter, so instead of ",(0,o.kt)("inlineCode",{parentName:"p"},'"DOTAAbilities"')," you could have ",(0,o.kt)("inlineCode",{parentName:"p"},'"MYOTHERFILE"'),", or even just empty string ",(0,o.kt)("inlineCode",{parentName:"p"},'""'),". You should not have identical keys in both root objects, but if you do then the ones defined later (think of #base happening before the rest of the file) will override already defined ones."),(0,o.kt)("p",null,"This also supports directories. Keep in mind all paths are relative. Say I create ",(0,o.kt)("inlineCode",{parentName:"p"},"scripts/npc/customAbilities/ability1.txt"),", I can include this from ",(0,o.kt)("inlineCode",{parentName:"p"},"scripts/npc/npc_abilities_custom.txt")," using ",(0,o.kt)("inlineCode",{parentName:"p"},'#base "customAbilities/ability1.txt"'),"."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"PS:")," Other extensions are also allowed, you could name your included files *.kv"),(0,o.kt)("h2",{id:"credits-for-pointing-out-this-is-part-of-the-kv-spec"},"Credits for pointing out this is part of the KV spec:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"XMPPwocky"),(0,o.kt)("li",{parentName:"ul"},"xPaw"),(0,o.kt)("li",{parentName:"ul"},"Netshroud")))}c.isMDXComponent=!0},6010:(e,t,n)=>{function i(e){var t,n,o="";if("string"==typeof e||"number"==typeof e)o+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=i(e[t]))&&(o&&(o+=" "),o+=n);else for(t in e)e[t]&&(o&&(o+=" "),o+=t);return o}function o(){for(var e,t,n=0,o="";n<arguments.length;)(e=arguments[n++])&&(t=i(e))&&(o&&(o+=" "),o+=t);return o}n.d(t,{Z:()=>o})}}]);