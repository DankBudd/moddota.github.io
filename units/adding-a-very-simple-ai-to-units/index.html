<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.58">
<link rel="search" type="application/opensearchdescription+xml" title="ModDota" href="/opensearch.xml"><title data-react-helmet="true">Adding a Very Simple AI to Units | ModDota</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Adding a Very Simple AI to Units | ModDota"><meta data-react-helmet="true" name="description" content="This tutorial will cover how to issue very simple orders to units. This tutorial uses a move order to make a unit wander inside an area randomly, and a cast order to make a unit cast an untargeted spell randomly."><meta data-react-helmet="true" property="og:description" content="This tutorial will cover how to issue very simple orders to units. This tutorial uses a move order to make a unit wander inside an area randomly, and a cast order to make a unit cast an untargeted spell randomly."><meta data-react-helmet="true" property="og:url" content="https://moddota.com/units/adding-a-very-simple-ai-to-units"><link data-react-helmet="true" rel="shortcut icon" href="/images/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://moddota.com/units/adding-a-very-simple-ai-to-units"><link rel="stylesheet" href="/styles.32eaf7f3.css">
<link rel="stylesheet" href="/main.49954070.css">
<link rel="preload" href="/styles.d89c53e5.js" as="script">
<link rel="preload" href="/runtime~main.aab74f50.js" as="script">
<link rel="preload" href="/main.2e2eb0b8.js" as="script">
<link rel="preload" href="/1.607a12f9.js" as="script">
<link rel="preload" href="/2.90bd4da8.js" as="script">
<link rel="preload" href="/1be78505.f231235a.js" as="script">
<link rel="preload" href="/ec1ed54d.18c72637.js" as="script">
<link rel="preload" href="/ba7e36fb.2e5fef83.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/images/logo-80x80.png"><strong class="navbar__title">ModDota</strong></a><a class="navbar__item navbar__link" href="/tutorials">Tutorials</a><a href="https://dota.tools/vscripts/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Lua API</a><a href="https://developer.valvesoftware.com/wiki/Dota_2_Workshop_Tools/Panorama/Javascript/API" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Panorama API</a></div><div class="navbar__items navbar__items--right"><a href="https://discord.gg/gRmZgvz" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Discord</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><div class="navbar__search"><div class="searchWrapper_-F3-"><span aria-label="expand searchbar" role="button" class="searchIconButton_1Dnz" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_2eto"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/images/logo-80x80.png"><strong class="navbar__title">ModDota</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/tutorials">Tutorials</a></li><li class="menu__list-item"><a href="https://dota.tools/vscripts/" target="_blank" rel="noopener noreferrer" class="menu__link">Lua API</a></li><li class="menu__list-item"><a href="https://developer.valvesoftware.com/wiki/Dota_2_Workshop_Tools/Panorama/Javascript/API" target="_blank" rel="noopener noreferrer" class="menu__link">Panorama API</a></li><li class="menu__list-item"><a href="https://discord.gg/gRmZgvz" target="_blank" rel="noopener noreferrer" class="menu__link">Discord</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1jis"><div class="docSidebarContainer_1kjN"><div class="sidebar_1kLs"><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/">Introduction</a></li><li class="menu__list-item"><a class="menu__link" href="/getting-started">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" href="/scripting-introduction">Scripting Introduction</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Abilities, items, modifiers</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/ability-keyvalues">Ability KeyValues</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/item-keyvalues">Item KeyValues</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/the-importance-of-abilityspecial-values">The importance of AbilitySpecial values</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/passing-abilityspecial-values-into-lua">Passing AbilitySpecial values into Lua</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/abilityduration-tooltips">AbilityDuration tooltips</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/simple-custom-ability">Simple Custom Ability</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/creating-innate-abilities">Creating innate (available from level 1) abilities</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/making-any-ability-use-charges">Making any ability use charges</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/calling-spells-with-setcursor">Calling Spells with SetCursor</a></li><li class="menu__list-item"><a href="https://developer.valvesoftware.com/wiki/Dota_2_Workshop_Tools/Lua_Abilities_and_Modifiers" target="_blank" rel="noreferrer noopener" class="menu__link" to="https://developer.valvesoftware.com/wiki/Dota_2_Workshop_Tools/Lua_Abilities_and_Modifiers" tabindex="-1">Lua Abilities and Modifiers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/lua-item-tutorial">Lua Item Tutorial</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Lua Modifiers</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/lua-modifiers/1">Extending Hero/NPC API with lua modifiers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/lua-modifiers/2">Linken&#x27;s Sphere &amp; Lotus Orb</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/lua-modifiers/3">Transformations</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/lua-modifiers/4">Enchanting Trees</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/reutilizing-built-in-modifiers">Reutilizing Built-In Modifiers</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Datadriven</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/datadriven/datadriven-ability-events-modifiers">DataDriven Ability Events &amp; Modifiers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/datadriven/all-about-the-target">All about the Target</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/datadriven/channeling-animations">Channeling Animations</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/datadriven/invisibility-ability-example">Invisibility Ability Example</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/datadriven/illusion-ability-example">Illusion Ability Example</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/datadriven/rotate-ability-example">Rotate Ability Example</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/datadriven/point-channeling-aoe-ability-example">Point Channeling AoE Ability Example</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/datadriven/apply-hero-and-creep-modifier-durations">Apply Hero and Creep modifier durations</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/datadriven/physics-ability-example-exorcism">Physics Ability Example - Exorcism</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Units</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/units/unit-keyvalues">Unit KeyValues</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/units/unit-producing-buildings">Unit producing buildings</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/units/creating-units-with-a-duration">Creating units with a duration</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/units/adding-a-very-simple-ai-to-units">Adding a Very Simple AI to Units</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/units/simple-neutral-ai">Writing a simple AI for neutrals</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/units/create-creature-attachwearable-blocks-directly-from-the-keyvalues">Create Creature AttachWearable blocks directly from the keyvalues</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Scripting</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/scripting/custom-mana-system">Custom Mana System</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/scripting/item-restrictions-requirements">Item Restrictions &amp; Requirements</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/scripting/item-drop-system">Item Drop System</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/scripting/making-a-rpg-like-looting-chest">Making a &quot;rpg-like&quot; looting chest</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/scripting/scripted-shop-spawning">Scripted Shop Spawning</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/scripting/lava-damage">Lava damage</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/scripting/using-dota-filters">Using the order filter and other filters</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/scripting/particle-attachment">Particle Attachment</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/scripting/precache-fixing-and-avoiding-issues">Precache, Fixing and avoiding issues</a></li><li class="menu__list-item"><a href="https://developer.valvesoftware.com/wiki/Dota_2_Workshop_Tools/Custom_Nettables" target="_blank" rel="noreferrer noopener" class="menu__link" to="https://developer.valvesoftware.com/wiki/Dota_2_Workshop_Tools/Custom_Nettables" tabindex="-1">Custom NetTables</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Panorama UI</a><ul class="menu__list"><li class="menu__list-item"><a href="https://developer.valvesoftware.com/wiki/Dota_2_Workshop_Tools/Panorama" target="_blank" rel="noreferrer noopener" class="menu__link" to="https://developer.valvesoftware.com/wiki/Dota_2_Workshop_Tools/Panorama" tabindex="-1">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/panorama/inclusive-panorama-ui">Inclusive Panorama UI</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/panorama/introduction-to-panorama-ui-with-typescript">Introduction to Panorama UI with TypeScript</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/panorama/keybindings">Keybindings</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/panorama/dotascenepanel">DOTAScenePanel</a></li><li class="menu__list-item"><a href="https://developer.valvesoftware.com/wiki/Dota_2_Workshop_Tools/Custom_Game_Setup" target="_blank" rel="noreferrer noopener" class="menu__link" to="https://developer.valvesoftware.com/wiki/Dota_2_Workshop_Tools/Custom_Game_Setup" tabindex="-1">Custom Game Setup</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/panorama/hiding-hud-with-sethudvisible">Hiding HUD with SetHUDVisible</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Assets</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/asset-file-type-reference">Asset File Type Reference</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Maps</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/maps/hammer-tutorials">Hammer Tutorials</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/maps/making-skip-clip-blocks-out-of-models">Making skip/clip blocks out of models</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Models</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/models/importing-custom-models">Importing custom models</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/models/mdl-to-vmdl-conversion">MDL to VMDL Conversion</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/models/adding-hitbox-to-models-without-a-bone">Adding Hitbox to Models without a Bone</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/models/importing-models-and-using-material-editor">Importing models and using the material editor</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/models/exporting-models-and-materials-textures">Exporting Models and Materials/Textures</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/models/custom-hero-models-materials-animations">Custom Hero models, materials and animations</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Particles</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/particles/particle-basics">Particle Basics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/particles/chaos-wave-particle">Chaos Wave Particle</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/particles/falling-cherry-blossom-petal-for-spring-mood-particle">Falling cherry blossom petal for spring mood particle</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/particles/volcano-particle">Volcano Particle</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/particles/status-effects">Status Effects</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/custom-sounds">Custom Sounds</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/extracting-and-compiling-vtex-files">Extracting and Compiling VTEX files</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/custom-minimap-icons">Custom Minimap Icons</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Tools</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tools/useful-console-commands">Useful Console Commands</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tools/setting-up-your-addon-with-github">Setting Up Your Addon With GitHub</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tools/combining-kv-files-using-base">Combining KV files using #base</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/contribute">Contribute</a></li></ul></div></div></div><main class="docMainContainer_3j_A"><div class="container padding-vert--lg docItemWrapper_1Hme"><div class="row"><div class="col docItemCol_2AGf"><div class="docItemContainer_1tAC"><article><div style="margin-top:-10px;margin-bottom:10px"><div class="row"><div class="col"><a href="https://github.com/ModDota/moddota.github.io/edit/source/_articles/units/adding-a-very-simple-ai-to-units.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col text--right"><em><small>Created on <time datetime="2015-07-27T00:00:00.000Z" class="docLastUpdatedAt_1gIo">7/27/2015</time> by <strong><a href="https://steamcommunity.com/profiles/76561198004447135">wigguno</a></strong></small></em></div></div></div><header><h1 class="docTitle_cWlf">Adding a Very Simple AI to Units</h1></header><div class="markdown"><p>This tutorial will cover how to issue very simple orders to units. This tutorial uses a move order to make a unit wander inside an area randomly, and a cast order to make a unit cast an untargeted spell randomly.</p><p>This tutorial assumes a basic knowledge of lua scripting.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="drawbacks"></a>Drawbacks<a aria-hidden="true" tabindex="-1" class="hash-link" href="#drawbacks" title="Direct link to heading">#</a></h2><ul><li>This technique should not be used for units which need to perform more than one kind of order each. If a more advanced AI is required, you should check holdout_example&#x27;s lua ai scripts.  </li><li>Some functionality is hard-coded into this script. If you want to iterate on your game and change the behaviour often, I would suggest having some global constants or loading in the values from an external KV file. Doing this allows you to keep all the values in one place.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="references"></a>References<a aria-hidden="true" tabindex="-1" class="hash-link" href="#references" title="Direct link to heading">#</a></h2><p>I&#x27;ve copied some units from holdout_example for testing, and copied Berserkers Call from <a href="https://github.com/Pizzalol/SpellLibrary" target="_blank" rel="noopener noreferrer">Spell Library</a>. </p><p>If you need help on making your own units or abilities, Noya&#x27;s documentation is an excellent resource:<br>
<a href="/articles/datadriven-units">Datadriven Units</a><br>
<a href="/articles/datadriven-ability-breakdown-documentation">DataDriven Ability Breakdown - Documentation</a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="hammer-setup"></a>Hammer Setup<a aria-hidden="true" tabindex="-1" class="hash-link" href="#hammer-setup" title="Direct link to heading">#</a></h2><p>In Hammer, I&#x27;ve placed an info_target entity named &quot;spawn_loc_test&quot; which can be found in lua. This allows me to place the units spawn location in Hammer without changing the lua scripts around. If you wish to do this, give each entity a unique name and place them where you want the spawn point on your map.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="lua-setup"></a>Lua Setup<a aria-hidden="true" tabindex="-1" class="hash-link" href="#lua-setup" title="Direct link to heading">#</a></h2><p>In the InitGameMode() function we do a few things: seed the random number generator, create an empty table in order to keep track of every unit with behaviour, spawn some units, and set a thinker function up. </p><p>Settings which aren&#x27;t relevant to this tutorial have been omitted, but in this function you can set up things like GameRules for your game mode. </p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-lua codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">function CAITesting:InitGameMode()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    print( &quot;Loading AI Testing Game Mode.&quot; )</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    -- SEEDING RNG IS VERY IMPORTANT</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    math.randomseed(Time())</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    -- Set up a table to hold all the units we want to spawn</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    self.UnitThinkerList = {}</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    -- Spawn some units</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    for i = 1,5 do</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        self:SpawnAIUnitWanderer()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    end</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    for i = 1,3 do</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        self:SpawnAIUnitCaster()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    end</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    -- Set the unit thinker function</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    GameRules:GetGameModeEntity():SetThink( &quot;OnUnitThink&quot;, self, &quot;UnitThink&quot;, 1 )</span></div><div class="token-line" style="color:#393A34"><span class="token plain">end</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="spawning-a-wanderer"></a>Spawning a Wanderer<a aria-hidden="true" tabindex="-1" class="hash-link" href="#spawning-a-wanderer" title="Direct link to heading">#</a></h2><p>This function will spawn a unit with wandering behaviour. The bounds which the unit wanders between are hard coded. An easy way to determine these bounds is to spawn a simple entity in Hammer (such as info_target), move it about and read the coordinates. In this example, my info_target entity is named &quot;spawn_loc_test&quot;.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-lua codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">function CAITesting:SpawnAIUnitWanderer()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    --Start an iteration finding each entity with this name</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    --If you&#x27;ve named everything with a unique name, this will return your entity on the first go</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    local spawnVectorEnt = Entities:FindByName(nil, &quot;spawn_loc_test&quot;)</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    -- GetAbsOrigin() is a function that can be called on any entity to get its location</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    local spawnVector = spawnVectorEnt:GetAbsOrigin()</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    -- Spawn the unit at the location on the neutral team</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    local spawnedUnit = CreateUnitByName(&quot;npc_dota_creature_kobold_tunneler&quot;, spawnVector, true, nil, nil, DOTA_TEAM_NEUTRALS)</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    -- make this unit passive</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    spawnedUnit:SetIdleAcquire(false)</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    -- Add some variables to the spawned unit so we know its intended behaviour</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    -- You can store anything here, and any time you get this entity the information will be intact</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    spawnedUnit.ThinkerType = &quot;wander&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    spawnedUnit.wanderBounds = {}</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    spawnedUnit.wanderBounds.XMin = -768</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    spawnedUnit.wanderBounds.XMax = 768</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    spawnedUnit.wanderBounds.YMin = -64</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    spawnedUnit.wanderBounds.YMax = 768</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    -- Add a random amount to the game time to randomise the behaviour a bit</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    spawnedUnit.NextOrderTime = GameRules:GetGameTime() + math.random(5, 10) </span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    -- finally, insert the unit into the table</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    table.insert(self.UnitThinkerList, spawnedUnit)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">end</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="spawning-a-caster"></a>Spawning a Caster<a aria-hidden="true" tabindex="-1" class="hash-link" href="#spawning-a-caster" title="Direct link to heading">#</a></h2><p>This function will spawn a unit with casting behaviour. The bounds which the unit is spawned in are hard coded. The spell is an untargeted spell which requires no additional variables to cast.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-lua codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">function CAITesting:SpawnAIUnitCaster()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    -- Generate a random location inside the neutrals area</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    local spawnVector = Vector(math.random(-768, 768), math.random(-64, 768), 128)</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    -- Spawn the unit at the location on the neutral team</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    local spawnedUnit = CreateUnitByName(&quot;npc_dota_creature_gnoll_assassin&quot;, spawnVector, true, nil, nil, DOTA_TEAM_NEUTRALS)</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    -- make this unit passive</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    spawnedUnit:SetIdleAcquire(false)</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    -- Add some variables to the spawned unit so we know its intended behaviour</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    -- You can store anything here, and any time you get this entity the information will be intact</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    spawnedUnit.ThinkerType = &quot;caster&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    spawnedUnit.CastAbilityIndex = spawnedUnit:GetAbilityByIndex(0):entindex()</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    -- Add a random amount to the game time to randomise the behaviour a bit</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    spawnedUnit.NextOrderTime = GameRules:GetGameTime() + math.random(5, 10) </span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    -- finally, insert the unit into the table</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    table.insert(self.UnitThinkerList, spawnedUnit)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">end</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="thinker-function"></a>Thinker Function<a aria-hidden="true" tabindex="-1" class="hash-link" href="#thinker-function" title="Direct link to heading">#</a></h2><p>This function gets called every second. It will read each of the units and determine if they should be issued with a new order, then issue that order.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-lua codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">function CAITesting:OnUnitThink()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    if GameRules:State_Get() == DOTA_GAMERULES_STATE_GAME_IN_PROGRESS then</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        local deadUnitCount = 0</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        -- Check each of the units in this table for their thinker behaviour</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        for ind, unit in pairs(self.UnitThinkerList) do</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            -- The first check should be to see if the units are still alive or not.</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            -- Keep track of how many units are removed from the table, as the indices will change by that amount</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            if unit:IsNull() or not unit:IsAlive() then</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                table.remove(self.UnitThinkerList, ind - deadUnitCount)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                deadUnitCount = deadUnitCount + 1</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            -- Check if the game time has passed our random time for next order</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            elseif GameRules:GetGameTime() &gt; unit.NextOrderTime then</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                if unit.ThinkerType == &quot;wander&quot; then</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    --print(&quot;thinker unit is a wanderer&quot;)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    --print(&quot;time: &quot; .. GameRules:GetGameTime() .. &quot;. next wander: &quot; .. unit.NextWanderTime)</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    -- Generate random coordinates to wander to</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    local x = math.random(unit.wanderBounds.XMin, unit.wanderBounds.XMax)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    local y = math.random(unit.wanderBounds.YMin, unit.wanderBounds.YMax)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    local z = GetGroundHeight(Vector(x, y, 128), nil)</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    print(&quot;wandering to x: &quot; .. x .. &quot; y: &quot; .. y)</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    -- Issue the movement order to the unit</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    unit:MoveToPosition(Vector(x, y, z))</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                elseif unit.ThinkerType == &quot;caster&quot; then</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    -- If you want a more complicated order, use this syntax</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    -- Some more documentation: https://developer.valvesoftware.com/wiki/Dota_2_Workshop_Tools/Scripting/API/Global.ExecuteOrderFromTable</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    -- Unit order list is here: https://developer.valvesoftware.com/wiki/Dota_2_Workshop_Tools/Panorama/Javascript/API#dotaunitorder_t</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    -- (Ignore the dotaunitorder_t. on each one)</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    print(&quot;casting ability &quot; .. EntIndexToHScript(unit.CastAbilityIndex):GetName())</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    local order = {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        UnitIndex = unit:entindex(),</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        AbilityIndex = unit.CastAbilityIndex,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        OrderType = DOTA_UNIT_ORDER_CAST_NO_TARGET,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        Queue = false</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    ExecuteOrderFromTable(order)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                end</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                -- Generate the next time for the order</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                unit.NextOrderTime = GameRules:GetGameTime() + math.random(5, 10)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            end</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        end</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        -- Make sure our testing map stays on day time      </span></div><div class="token-line" style="color:#393A34"><span class="token plain">        if not GameRules:IsDaytime() then</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            GameRules:SetTimeOfDay(0.26)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        end</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    elseif GameRules:State_Get() &gt;= DOTA_GAMERULES_STATE_POST_GAME then</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        return nil</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    end</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    -- this return statement means that this thinker function will be called again in 1 second</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    -- returning nil will cause the thinker to terminate and no longer be called</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    return 1</span></div><div class="token-line" style="color:#393A34"><span class="token plain">end</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="finishing-up"></a>Finishing Up<a aria-hidden="true" tabindex="-1" class="hash-link" href="#finishing-up" title="Direct link to heading">#</a></h2><p>If you need more advanced behaviour, an AI script should be used. The method covered in this tutorial can be extended up to a point however, for example casting a ground-targeted ability in a random area would be possible using only code posted here.</p><p>The full files for this example can be found here:
<a href="https://github.com/Wigguno/AITesting" target="_blank" rel="noopener noreferrer">https://github.com/Wigguno/AITesting</a></p><p>If you have any questions, the <a href="https://moddota.com/forums/chat" target="_blank" rel="noopener noreferrer">#dota2modhelpdesk</a> irc channel is always happy to help.</p></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/units/creating-units-with-a-duration"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Creating units with a duration</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/units/simple-neutral-ai"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Writing a simple AI for neutrals »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_tVyB"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#drawbacks" class="table-of-contents__link">Drawbacks</a></li><li><a href="#references" class="table-of-contents__link">References</a></li><li><a href="#hammer-setup" class="table-of-contents__link">Hammer Setup</a></li><li><a href="#lua-setup" class="table-of-contents__link">Lua Setup</a></li><li><a href="#spawning-a-wanderer" class="table-of-contents__link">Spawning a Wanderer</a></li><li><a href="#spawning-a-caster" class="table-of-contents__link">Spawning a Caster</a></li><li><a href="#thinker-function" class="table-of-contents__link">Thinker Function</a></li><li><a href="#finishing-up" class="table-of-contents__link">Finishing Up</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/styles.d89c53e5.js"></script>
<script src="/runtime~main.aab74f50.js"></script>
<script src="/main.2e2eb0b8.js"></script>
<script src="/1.607a12f9.js"></script>
<script src="/2.90bd4da8.js"></script>
<script src="/1be78505.f231235a.js"></script>
<script src="/ec1ed54d.18c72637.js"></script>
<script src="/ba7e36fb.2e5fef83.js"></script>
</body>
</html>