<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.55">
<link rel="search" type="application/opensearchdescription+xml" title="ModDota" href="/opensearch.xml"><title data-react-helmet="true">Enchanting Trees | ModDota</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Enchanting Trees | ModDota"><meta data-react-helmet="true" name="description" content="Without further delay. Lets get to it!"><meta data-react-helmet="true" property="og:description" content="Without further delay. Lets get to it!"><meta data-react-helmet="true" property="og:url" content="https://moddota.com/abilities/lua-modifiers/4"><link data-react-helmet="true" rel="shortcut icon" href="/images/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://moddota.com/abilities/lua-modifiers/4"><link rel="stylesheet" href="/styles.e4f40703.css">
<link rel="stylesheet" href="/main.0665fc68.css">
<link rel="preload" href="/styles.43968241.js" as="script">
<link rel="preload" href="/runtime~main.6f49613a.js" as="script">
<link rel="preload" href="/main.54dcce36.js" as="script">
<link rel="preload" href="/1.e31b636a.js" as="script">
<link rel="preload" href="/2.6f67e170.js" as="script">
<link rel="preload" href="/1be78505.c6a00832.js" as="script">
<link rel="preload" href="/ec1ed54d.7a084ae5.js" as="script">
<link rel="preload" href="/25225fa8.60e7d509.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/images/logo-80x80.png"><strong class="navbar__title">ModDota</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Tutorials</a><a target="_blank" rel="noopener noreferrer" href="https://dota.tools/vscripts/" class="navbar__item navbar__link">Lua API</a><a target="_blank" rel="noopener noreferrer" href="https://developer.valvesoftware.com/wiki/Dota_2_Workshop_Tools/Panorama/Javascript/API" class="navbar__item navbar__link">Panorama API</a></div><div class="navbar__items navbar__items--right"><a target="_blank" rel="noopener noreferrer" href="https://discord.gg/gRmZgvz" class="navbar__item navbar__link">Discord</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input search-bar"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/images/logo-80x80.png"><strong class="navbar__title">ModDota</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/">Tutorials</a></li><li class="menu__list-item"><a target="_blank" rel="noopener noreferrer" href="https://dota.tools/vscripts/" class="menu__link">Lua API</a></li><li class="menu__list-item"><a target="_blank" rel="noopener noreferrer" href="https://developer.valvesoftware.com/wiki/Dota_2_Workshop_Tools/Panorama/Javascript/API" class="menu__link">Panorama API</a></li><li class="menu__list-item"><a target="_blank" rel="noopener noreferrer" href="https://discord.gg/gRmZgvz" class="menu__link">Discord</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1jis"><div class="docSidebarContainer_1kjN"><div class="sidebar_1kLs"><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/">Introduction</a></li><li class="menu__list-item"><a class="menu__link" href="/getting-started">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" href="/scripting-introduction">Scripting Introduction</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Abilities, items, modifiers</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/abilities/ability-keyvalues">Ability KeyValues</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/abilities/item-keyvalues">Item KeyValues</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/abilities/the-importance-of-abilityspecial-values">The importance of AbilitySpecial values</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/abilities/passing-abilityspecial-values-into-lua">Passing AbilitySpecial values into Lua</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/abilities/abilityduration-tooltips">AbilityDuration tooltips</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/abilities/simple-custom-ability">Simple Custom Ability</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/abilities/creating-innate-abilities">Creating innate (available from level 1) abilities</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/abilities/making-any-ability-use-charges">Making any ability use charges</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/abilities/calling-spells-with-setcursor">Calling Spells with SetCursor</a></li><li class="menu__list-item"><a class="menu__link" to="https://developer.valvesoftware.com/wiki/Dota_2_Workshop_Tools/Lua_Abilities_and_Modifiers" target="_blank" rel="noreferrer noopener" tabindex="0" href="https://developer.valvesoftware.com/wiki/Dota_2_Workshop_Tools/Lua_Abilities_and_Modifiers">Lua Abilities and Modifiers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/abilities/lua-item-tutorial">Lua Item Tutorial</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Lua Modifiers</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/abilities/lua-modifiers/1">Extending Hero/NPC API with lua modifiers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/abilities/lua-modifiers/2">Linken&#x27;s Sphere &amp; Lotus Orb</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/abilities/lua-modifiers/3">Transformations</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/abilities/lua-modifiers/4">Enchanting Trees</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/abilities/reutilizing-built-in-modifiers">Reutilizing Built-In Modifiers</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Datadriven</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/datadriven/datadriven-ability-events-modifiers">DataDriven Ability Events &amp; Modifiers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/datadriven/all-about-the-target">All about the Target</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/datadriven/channeling-animations">Channeling Animations</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/datadriven/invisibility-ability-example">Invisibility Ability Example</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/datadriven/illusion-ability-example">Illusion Ability Example</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/datadriven/rotate-ability-example">Rotate Ability Example</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/datadriven/point-channeling-aoe-ability-example">Point Channeling AoE Ability Example</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/datadriven/apply-hero-and-creep-modifier-durations">Apply Hero and Creep modifier durations</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/abilities/datadriven/physics-ability-example-exorcism">Physics Ability Example - Exorcism</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Units</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/units/unit-keyvalues">Unit KeyValues</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/units/unit-producing-buildings">Unit producing buildings</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/units/creating-units-with-a-duration">Creating units with a duration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/units/adding-a-very-simple-ai-to-units">Adding a Very Simple AI to Units</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/units/simple-neutral-ai">Writing a simple AI for neutrals</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/units/create-creature-attachwearable-blocks-directly-from-the-keyvalues">Create Creature AttachWearable blocks directly from the keyvalues</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Scripting</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/scripting/custom-mana-system">Custom Mana System</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/scripting/item-restrictions-requirements">Item Restrictions &amp; Requirements</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/scripting/item-drop-system">Item Drop System</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/scripting/making-a-rpg-like-looting-chest">Making a &quot;rpg-like&quot; looting chest</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/scripting/scripted-shop-spawning">Scripted Shop Spawning</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/scripting/lava-damage">Lava damage</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/scripting/using-dota-filters">Using the order filter and other filters</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/scripting/particle-attachment">Particle Attachment</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/scripting/precache-fixing-and-avoiding-issues">Precache, Fixing and avoiding issues</a></li><li class="menu__list-item"><a class="menu__link" to="https://developer.valvesoftware.com/wiki/Dota_2_Workshop_Tools/Custom_Nettables" target="_blank" rel="noreferrer noopener" tabindex="-1" href="https://developer.valvesoftware.com/wiki/Dota_2_Workshop_Tools/Custom_Nettables">Custom NetTables</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Panorama UI</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" to="https://developer.valvesoftware.com/wiki/Dota_2_Workshop_Tools/Panorama" target="_blank" rel="noreferrer noopener" tabindex="-1" href="https://developer.valvesoftware.com/wiki/Dota_2_Workshop_Tools/Panorama">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/panorama/inclusive-panorama-ui">Inclusive Panorama UI</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/panorama/introduction-to-panorama-ui-with-typescript">Introduction to Panorama UI with TypeScript</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/panorama/keybindings">Keybindings</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/panorama/dotascenepanel">DOTAScenePanel</a></li><li class="menu__list-item"><a class="menu__link" to="https://developer.valvesoftware.com/wiki/Dota_2_Workshop_Tools/Custom_Game_Setup" target="_blank" rel="noreferrer noopener" tabindex="-1" href="https://developer.valvesoftware.com/wiki/Dota_2_Workshop_Tools/Custom_Game_Setup">Custom Game Setup</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/panorama/hiding-hud-with-sethudvisible">Hiding HUD with SetHUDVisible</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Assets</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/asset-file-type-reference">Asset File Type Reference</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Maps</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/maps/hammer-tutorials">Hammer Tutorials</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/maps/making-skip-clip-blocks-out-of-models">Making skip/clip blocks out of models</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Models</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/models/importing-custom-models">Importing custom models</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/models/mdl-to-vmdl-conversion">MDL to VMDL Conversion</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/models/adding-hitbox-to-models-without-a-bone">Adding Hitbox to Models without a Bone</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/models/importing-models-and-using-material-editor">Importing models and using the material editor</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/models/exporting-models-and-materials-textures">Exporting Models and Materials/Textures</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/models/custom-hero-models-materials-animations">Custom Hero models, materials and animations</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Particles</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/particles/particle-basics">Particle Basics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/particles/chaos-wave-particle">Chaos Wave Particle</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/particles/falling-cherry-blossom-petal-for-spring-mood-particle">Falling cherry blossom petal for spring mood particle</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/particles/volcano-particle">Volcano Particle</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/particles/status-effects">Status Effects</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/custom-sounds">Custom Sounds</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/extracting-and-compiling-vtex-files">Extracting and Compiling VTEX files</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/assets/custom-minimap-icons">Custom Minimap Icons</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Tools</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tools/useful-console-commands">Useful Console Commands</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tools/setting-up-your-addon-with-github">Setting Up Your Addon With GitHub</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tools/combining-kv-files-using-base">Combining KV files using #base</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/contribute">Contribute</a></li><li class="menu__list-item"><a class="menu__link" href="/tutorials">Tutorial overview</a></li></ul></div></div></div><main class="docMainContainer_3j_A"><div class="container padding-vert--lg docItemWrapper_1Hme"><div class="row"><div class="col docItemCol_2AGf"><div class="docItemContainer_1tAC"><article><div style="margin-top:-10px;margin-bottom:10px"><div class="row"><div class="col"><a href="https://github.com/ModDota/moddota.github.io/edit/source/_articles/abilities/lua-modifiers/4.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col text--right"><em><small>Created on <time datetime="2016-09-08T00:00:00.000Z" class="docLastUpdatedAt_1gIo">9/8/2016</time> by <strong><a href="https://steamcommunity.com/profiles/76561197975484185">DrTeaSpoon</a></strong></small></em></div></div></div><header><h1 class="docTitle_cWlf">Enchanting Trees</h1></header><div class="markdown"><p>Without further delay. Lets get to it!<br>
<code>npc_abilities_custom.txt</code> entry for our ability.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">&quot;enchant_tree_lua&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">{</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // These are required for this to work</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    &quot;BaseClass&quot;             &quot;ability_lua&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    &quot;ScriptFile&quot;                    &quot;lua_abilities/enchant_tree/ability.lua&quot; //set your script file path in &#x27;vscripts&#x27; folder</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    &quot;AbilityBehavior&quot;               &quot;DOTA_ABILITY_BEHAVIOR_UNIT_TARGET&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    &quot;AbilityUnitTargetTeam&quot;         &quot;DOTA_UNIT_TARGET_TEAM_CUSTOM&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    &quot;AbilityUnitTargetType&quot;         &quot;DOTA_UNIT_TARGET_TREE&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    &quot;AbilityDuration&quot;               &quot;10.0&quot; //well, technically optional.</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // Optional stuff</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    &quot;AbilityTextureName&quot;            &quot;enchant_tree_lua&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    &quot;AbilityCastPoint&quot;              &quot;0.1&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    &quot;AbilityCooldown&quot;               &quot;5.0&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    &quot;AbilityManaCost&quot;               &quot;100&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    &quot;AbilityCastRange&quot;              &quot;400&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div></div></div></div></div><p>This is your basic start for lua ability.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-lua codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">if enchant_tree_lua == nil then</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    enchant_tree_lua = class({})</span></div><div class="token-line" style="color:#393A34"><span class="token plain">end</span></div><div class="token-line" style="color:#393A34"><span class="token plain">LinkLuaModifier( &quot;enchant_tree_lua_mod&quot;, &quot;lua_abilities/enchant_tree/modifier.lua&quot;, LUA_MODIFIER_MOTION_NONE )</span></div></div></div></div></div><p>The magic happens here. <code>CreateModifierThinker</code> creates sort of invisible unit with modifier attached to it.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-lua codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">function enchant_tree_lua:OnSpellStart()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    CreateModifierThinker( self:GetCaster(), self, &quot;enchant_tree_lua_mod&quot;, { duration = self:GetDuration() }, self:GetCursorPosition(), self:GetCaster():GetTeamNumber(), true )</span></div><div class="token-line" style="color:#393A34"><span class="token plain">end</span></div></div></div></div></div><p>Now for the next piece of magic we need to setup our cool modifier. In this example the file path would be &quot;vscripts/lua_abilities/enchant_tree/modifier.lua&quot;.<br>
There are two major parts for every &#x27;tree enchantment&#x27;. First is making sure that we have tree nearby. Because of engine limitations the trees are difficult to interact with. For our solution we are simply requesting from gridnav every half a second if there is trees in very small area at our thinker unit&#x27;s location.<br>
The last part is minor optimization that may become redundant but was not at the time of developing this. There was issue where the thinker unit would remain on the map for some time after the modifier was destroyed.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-lua codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">if enchant_tree_lua_mod == nil then</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    enchant_tree_lua_mod = class({})</span></div><div class="token-line" style="color:#393A34"><span class="token plain">end</span></div><div class="token-line" style="color:#393A34"><span class="token plain">function enchant_tree_lua_mod:OnCreated( kv )   </span></div><div class="token-line" style="color:#393A34"><span class="token plain">    if IsServer() then</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        self:StartIntervalThink(0.5)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    end</span></div><div class="token-line" style="color:#393A34"><span class="token plain">end</span></div><div class="token-line" style="color:#393A34"><span class="token plain">function enchant_tree_lua_mod:OnIntervalThink()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    if IsServer() then</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        if not GridNav:IsNearbyTree(self:GetParent():GetAbsOrigin(), 10, false) then</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            self:Destroy()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        end</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    end</span></div><div class="token-line" style="color:#393A34"><span class="token plain">end</span></div><div class="token-line" style="color:#393A34"><span class="token plain">function enchant_tree_lua_mod:OnDestroy()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    if IsServer() then</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        UTIL_Remove( self:GetParent() )</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    end</span></div><div class="token-line" style="color:#393A34"><span class="token plain">end</span></div></div></div></div></div><p>Now comes the fun part. What do we want to do with this modifier.<br>
I decided to go with soul collecting tree: if enemy hero is killed in radius(you need to add this to special values of your <code>npc_abilities_custom.txt</code>) the owner of the spell steal up to 2 of victim&#x27;s primary stat.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-lua codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">function enchant_tree_lua_mod:DeclareFunctions()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    local funcs = {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        MODIFIER_EVENT_ON_HERO_KILLED</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    return funcs</span></div><div class="token-line" style="color:#393A34"><span class="token plain">end</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">function enchant_tree_lua_mod:OnHeroKilled(kv)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    if IsServer() then</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        if kv.unit and kv.unit:GetTeam() ~= self:GetCaster():GetTeam() then</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            if (self:GetParent():GetAbsOrigin() - kv.unit:GetAbsOrigin()):Length2D() &lt;= self:GetAbility():GetSpecialValueFor(&quot;radius&quot;) then</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                self:CollectSoul(kv.unit)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            end</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        end</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    end</span></div><div class="token-line" style="color:#393A34"><span class="token plain">end</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">function enchant_tree_lua_mod:CollectSoul(hTarget)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  local primary = hTarget:GetPrimaryAttribute()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  local val = hTarget:GetPrimaryStatValue()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  local n = math.max (0, math.min(2,val))</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  if primary == 0 then</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    self:GetCaster():ModifyStrength(n) </span></div><div class="token-line" style="color:#393A34"><span class="token plain">    hTarget:ModifyStrength(n*-1) </span></div><div class="token-line" style="color:#393A34"><span class="token plain">  elseif primary == 1 then</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    self:GetCaster():ModifyAgility(n) </span></div><div class="token-line" style="color:#393A34"><span class="token plain">    hTarget:ModifyAgility(n*-1) </span></div><div class="token-line" style="color:#393A34"><span class="token plain">  else</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    self:GetCaster():ModifyIntellect(n) </span></div><div class="token-line" style="color:#393A34"><span class="token plain">    hTarget:ModifyIntellect(n*-1) </span></div><div class="token-line" style="color:#393A34"><span class="token plain">  end</span></div><div class="token-line" style="color:#393A34"><span class="token plain">end</span></div></div></div></div></div><p>For those fancy effects that ironwood tree has you might want to add these lines</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-lua codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">function enchant_tree_lua_mod:GetEffectName()</span></div><div class="token-line" style="color:#393A34"><span class="token plain"> return &quot;particles/items_fx/ironwood_tree.vpcf&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">end</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">function enchant_tree_lua_mod:GetEffectAttachType()</span></div><div class="token-line" style="color:#393A34"><span class="token plain"> return PATTACH_OVERHEAD_FOLLOW</span></div><div class="token-line" style="color:#393A34"><span class="token plain">end</span></div></div></div></div></div><p>Next Topic: <a href="/abilities/lua-modifiers/lua-modifiers-5">Stacking Modifiers</a></p></div></article><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/abilities/lua-modifiers/3"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Transformations</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/abilities/reutilizing-built-in-modifiers"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Reutilizing Built-In Modifiers »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_tVyB"></div></div></div></div></main></div></div></div>
<script src="/styles.43968241.js"></script>
<script src="/runtime~main.6f49613a.js"></script>
<script src="/main.54dcce36.js"></script>
<script src="/1.e31b636a.js"></script>
<script src="/2.6f67e170.js"></script>
<script src="/1be78505.c6a00832.js"></script>
<script src="/ec1ed54d.7a084ae5.js"></script>
<script src="/25225fa8.60e7d509.js"></script>
</body>
</html>